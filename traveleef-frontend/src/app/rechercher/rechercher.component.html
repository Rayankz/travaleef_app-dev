<div class="recherche-container">
  <h1>Recherche :</h1>

  <!-- Formulaire de recherche -->
  <div class="formulaire-recherche">
    <input type="text" placeholder="D√©part (ex: CDG)" [(ngModel)]="departureId" />
    <input type="text" placeholder="Arriv√©e (ex: JFK)" [(ngModel)]="arrivalId" />
    <input type="date" placeholder="Date de d√©part" [(ngModel)]="outboundDate" />
    <input type="date" placeholder="Date d'arriv√©e" [(ngModel)]="returnDate" />
    <input type="number" placeholder="Nombre de passagers" min="1" [(ngModel)]="passengerCount" />
    <button (click)="rechercherVols()">Rechercher</button>
  </div>

  <!-- Affichage des erreurs -->
  <div class="error-message" *ngIf="errorMessage">{{ errorMessage }}</div>

  <!-- R√©sultats -->
  <div class="contenu-recherche">
    <div class="resultats">
      <h2>R√©sultats :</h2>
      <div *ngIf="filteredResults.length > 0; else noResultTemplate">
        <div
          class="resultat hover-effect"
          *ngFor="let flight of filteredResults"
          (click)="openDetails(flight)"
        >
          <h3>
            {{ flight.flights[0]?.departure_airport?.name }} ‚û°Ô∏è
            {{ flight.flights[0]?.arrival_airport?.name }}
            <span>{{ flight.total_duration }} min</span>
          </h3>
          <p>
            {{ getCO2PerPerson(flight.carbon_emissions?.this_flight) }} kg CO‚ÇÇ/Pers. - {{ flight.price }} ‚Ç¨
          </p>
          <img
            *ngIf="flight.airline_logo"
            [src]="flight.airline_logo"
            alt="Logo Compagnie"
            class="airline-logo"
          />
        </div>
      </div>
      <ng-template #noResultTemplate>
        <div class="no-result">Aucun r√©sultat trouv√©.</div>
      </ng-template>
    </div>

    <!-- Filtres -->
    <div class="filtres">
      <h3>Filtres</h3>

      <!-- Filtre : Tranche de prix -->
      <div class="filtre-item">
        <label>Tranche de prix (max)</label>
        <input type="range" min="0" max="10000" [(ngModel)]="maxPrice" (input)="applyFilters()" />
        <span>{{ maxPrice }}‚Ç¨</span>
      </div>

      <!-- Filtre : Dur√©e -->
      <div class="filtre-item">
        <label>Dur√©e (max en min)</label>
        <input type="range" min="0" max="5000" [(ngModel)]="maxDuration" (input)="applyFilters()" />
        <span>{{ maxDuration }} min</span>
      </div>

      <!-- Filtre : Empreinte carbone -->
      <div class="filtre-item">
        <label>Empreinte carbone (max en kg)</label>
        <input type="range" min="0" max="5000" [(ngModel)]="maxCO2" (input)="applyFilters()" />
        <span>{{ maxCO2 }} kg CO‚ÇÇ</span>
      </div>

      <!-- Filtre : Moyens de transport -->
      <div class="filtre-item">
        <label>Moyens de transport</label>
        <div class="transport-options">
          <label><input type="checkbox" /> Avion ‚úàÔ∏è</label>
          <label><input type="checkbox" /> Train üöÜ</label>
          <label><input type="checkbox" /> Bus üöå</label>
          <label><input type="checkbox" /> Covoiturage üöó</label>
          <label><input type="checkbox" /> Bateaux üö¢</label>
        </div>
      </div>

      <!-- Filtre : Accessibilit√© -->
      <div class="filtre-item">
        <label>Accessibilit√©</label>
        <div>
          <label><input type="checkbox" /> Accessibilit√© üßë‚Äçü¶Ω</label>
        </div>
      </div>

      <!-- Filtre : Labels √©cologiques -->
      <div class="filtre-item">
        <label>Labels √©cologiques</label>
        <select>
          <option value="aucun">Aucun</option>
          <option value="eco1">Label 1</option>
          <option value="eco2">Label 2</option>
        </select>
      </div>

      <!-- Filtre : Classe de voyage -->
      <div class="filtre-item">
        <label>Classe de voyage</label>
        <select>
          <option value="eco">√âconomique</option>
          <option value="premium">Premium</option>
          <option value="business">Business</option>
          <option value="first">Premi√®re classe</option>
        </select>
      </div>
    </div>
  </div>

  <!-- Popup des d√©tails -->
  <div class="popup" *ngIf="selectedFlight">
    <div class="popup-content">
      <h2>D√©tails du vol</h2>
      <img
        *ngIf="selectedFlight.airline_logo"
        [src]="selectedFlight.airline_logo"
        alt="Logo Compagnie"
        class="airline-logo-detail"
      />
      <p><strong>Compagnie :</strong> {{ selectedFlight.flights[0]?.airline }}</p>
      <p><strong>Avion :</strong> {{ selectedFlight.flights[0]?.airplane }}</p>
      <p><strong>Dur√©e :</strong> {{ selectedFlight.total_duration }} min</p>
      <p><strong>D√©part :</strong> {{ selectedFlight.flights[0]?.departure_airport?.name }}</p>
      <p><strong>Arriv√©e :</strong> {{ selectedFlight.flights[0]?.arrival_airport?.name }}</p>
      <p><strong>Prix :</strong> {{ selectedFlight.price }} ‚Ç¨</p>
      <p><strong>√âmissions de CO‚ÇÇ :</strong> {{ getCO2PerPerson(selectedFlight.carbon_emissions?.this_flight) }} kg</p>
      <p><strong>Classe de voyage :</strong> {{ selectedFlight.flights[0]?.travel_class }}</p>
      <button (click)="closeDetails()">Fermer</button>
    </div>
  </div>
</div>
